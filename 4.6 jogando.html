<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sherlock - Jogar com Modelo Treinado</title>
    <style>
        .scoreboard {
            margin-top: 20px;
            border: 1px solid #000;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h1>Sherlock - Jogo de Palpites</h1>

    <!-- Carregar Modelo Salvo -->
    <h2>Carregar Modelo Salvo</h2>
    <input type="file" id="modelJson" accept=".json"/>
    <input type="file" id="modelWeights" accept=".bin"/>
    <button onclick="carregarModelo()">Carregar Modelo</button>
    <p id="statusModelo"></p>

    <!-- Jogar com o Modelo Carregado -->
    <h2>Jogar com Sherlock</h2>
    <button onclick="jogarComModelo()">Jogar</button>

    <!-- Placar dos Palpites -->
    <div class="scoreboard" id="scoreboard">
        <h3>Palpites Gerados:</h3>
        <div id="resultadosCiclo"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script>
        let model;
        let palpites = [];

        // Função para carregar o modelo salvo
        async function carregarModelo() {
            const jsonUpload = document.getElementById('modelJson').files[0];
            const weightsUpload = document.getElementById('modelWeights').files[0];

            if (jsonUpload && weightsUpload) {
                model = await tf.loadLayersModel(tf.io.browserFiles([jsonUpload, weightsUpload]));
                document.getElementById('statusModelo').innerText = "Modelo carregado com sucesso!";
            } else {
                alert("Por favor, carregue ambos os arquivos .json e .bin!");
            }
        }

        // Função para jogar com o modelo carregado
        function jogarComModelo() {
            if (!model) {
                alert("Por favor, carregue o modelo antes de jogar!");
                return;
            }

            alert("Jogando com o modelo carregado...");
            gerarPalpites();
            exibirResultados(palpites);
        }

        // Função para gerar palpites com o modelo carregado
        function gerarPalpites() {
            palpites = [];
            const input = tf.tensor2d([Array(15).fill(0.5)]);  // Usando um exemplo arbitrário de entrada

            for (let i = 0; i < 50; i++) {  // Gerar 50 palpites
                const predicao = model.predict(input).dataSync();
                const bolasPrevistas = Array.from(predicao).map(p => Math.round(p * 25)).slice(0, 15);
                palpites.push(bolasPrevistas);
            }
        }

        // Função para exibir os resultados dos palpites
        function exibirResultados(palpites) {
            const resultadosDiv = document.getElementById('resultadosCiclo');
            resultadosDiv.innerHTML = '';  // Limpa os resultados anteriores

            palpites.forEach((palpite, index) => {
                const palpiteText = `Palpite ${index + 1}: ${palpite.join(", ")}`;
                const pElement = document.createElement('p');
                pElement.innerText = palpiteText;
                resultadosDiv.appendChild(pElement);
            });
        }
    </script>
</body>
</html>
